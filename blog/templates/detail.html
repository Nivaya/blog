{% extends 'base.html' %}
{% import 'bootstrap/wtf.html' as wtf %}


{% block body_attribs %}
    class="user-select single"
{% endblock body_attribs %}


{% block content %}
    <header class="article-header">
        {% if current_user.is_authenticated %}
            <a href="{{ url_for('write',id=article.id) }}">
                <h1 class="article-title">{{ article.title }}</h1>
            </a>
        {% else %}
            <h1 class="article-title">{{ article.title }}</h1>
        {% endif %}
        <div class="article-meta">
                    <span class="item article-meta-time">
                        <time class="time" data-toggle="tooltip" data-placement="bottom" title=""
                              data-original-title="发表时间：{{ article.create_date }}">
                            <i class="glyphicon glyphicon-time"></i>&nbsp;{{ article.create_date }}
                        </time>
                    </span>
            <span class="item article-meta-source" data-toggle="tooltip" data-placement="bottom" title=""
                  data-original-title="来源：啊姚大仙的博客">
                        <i class="glyphicon glyphicon-globe"></i>&nbsp;啊姚大仙的博客
                    </span>
            <span class="item article-meta-category" data-toggle="tooltip" data-placement="bottom" title=""
                  data-original-title="{{ article.catalogs.catalog }}">
                        <i class="glyphicon glyphicon-list"></i>&nbsp;{{ article.catalogs.catalog }}
                    </span>
            <span class="item article-meta-views" data-toggle="tooltip" data-placement="bottom" title=""
                  data-original-title="浏览量：{{ article.visited }}">
                        <i class="glyphicon glyphicon-eye-open"></i>&nbsp;{{ article.visited }}</span>
            <span class="item article-meta-comment" data-toggle="tooltip" data-placement="bottom" title=""
                  data-original-title="评论量">
                        <i class="glyphicon glyphicon-comment"></i>&nbsp;
                    </span>
        </div>
        <div class="article-tags">
            {% for tag in tags %}
                <a href="{{ url_for('catalog_list',catalog='search',tag=tag.tag) }}" rel="tag">{{ tag.tag }}</a>
            {% endfor %}
        </div>
    </header>
    <article class="article-content">
        {{ article.body_html | safe }}
        <hr>
    </article>


    <div class="title" id="comment">
        <h3 style="margin-top: 25px">评论</h3>
    </div>
    <div id="respond">
        <form id="comment-form" name="comment-form" action="{{ url_for('detail',id=article.id) }}#comment"
              method="POST">
            <div class="comment">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <input name="username" class="form-control" size="22" placeholder="您的昵称（必填）" maxlength="15"
                       autocomplete="off" tabindex="1" type="text" required>
                <input name="email" class="form-control" size="22" placeholder="您的网址或邮箱（非必填）" maxlength="50"
                       autocomplete="off" tabindex="2" type="text">
                <div class="comment-box">
                    <textarea placeholder="您的评论或留言（必填）" name="comment" id="comment-textarea" required
                              cols="100%" rows="3" tabindex="3" maxlength="150"></textarea>
                    <div class="comment-ctrl">
                        <div class="comment-prompt" style="display: none;">
                            <i class="fa fa-spin fa-circle-o-notch"></i>
                            <span class="comment-prompt-text">评论正在提交中...请稍后</span>
                        </div>
                        <div class="comment-success" style="display: none;">
                            <i class="fa fa-check"></i>
                            <span class="comment-prompt-text">评论提交成功...</span>
                        </div>
                        <button type="submit" name="comment_submit" id="comment-submit" tabindex="4" value="Y">评论
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div id="postcomments">
        <ol id="comment_list" class="commentlist">
            {% for comment in comments %}
                <li class="comment-content">
                    <div class="comment-avatar">
                        <img class="avatar" src="../static/images/avatar_default.jpg" alt="commentor">
                    </div>
                    <span class="comment-f">#{{ comment.row_num | int }}</span>
                    <div class="comment-main">
                        <p><span style="color: #2e6da4">{{ comment.create_user }}</span>
                            <span class="time">({{ comment.create_date }})</span><br>{{ comment.body | safe }}
                        </p>
                    </div>
                </li>
            {% endfor %}
        </ol>
    </div>
{% endblock %}

{% block sidebar %}
    {% include 'notepad.html' %}
{% endblock %}

